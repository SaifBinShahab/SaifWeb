<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"  lang="en" data-theme="dark">
<head>
	<!-- 2025-09-03 Wed 21:48 -->
<!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-KBK5T6P9');</script>
<!-- End Google Tag Manager -->
	<meta charset="UTF-8" />
	<meta name="description" content="Saif Bin Shahab is an experienced Cyber Security Specialist and Software Developer. He is also the Founder of Vault47 Cyber Security." />
	<meta name="keywords" content="cyber security, ethical hacker, developer, portfolio, software development, web development, projects, homelab, linux" />
	<meta name="viewport" content="width=device-width, initial-scale=1" />
	<meta name="theme-color" content="purple" />
		<meta name="theme-color" content="purple" media="(prefers-color-scheme:dark)" />
	<title>Setting up ModSecurity WAF for Apache Webserver - Saif Bin Shahab</title>
	<link rel="canonical" href="https://saif-it.pages.dev/blog/modsecurity-install-apache/" /><link rel="icon" type="image/png" href="https://saif-it.pages.dev/favicon.png" />

<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="https://saif-it.pages.dev/apple-touch-icon.png" />

		
			
				<link rel="alternate" type="application/rss+xml" title="Saif Bin Shahab - RSS Feed" href="https://saif-it.pages.dev/rss.xml">
			
		
			
				<link rel="alternate" type="application/atom+xml" title="Saif Bin Shahab - Atom Feed" href="https://saif-it.pages.dev/atom.xml">
			
		
    <style type="text/css">
	:root {--accent-color: purple;}[data-theme="dark"] {
			--accent-color: purple;
		}

		@media (prefers-color-scheme: dark) {
			:root:not([data-theme="light"]) {
				--accent-color: purple;
			}
		}</style>

			<link type="text/css" rel="stylesheet" href="https://saif-it.pages.dev/style.css" />
				<link type="text/css" rel="stylesheet" href="https://saif-it.pages.dev/syntax-theme-light.css" media="(prefers-color-scheme: light)" />
				<link type="text/css" rel="stylesheet" href="https://saif-it.pages.dev/syntax-theme-dark.css" media="(prefers-color-scheme: dark)" />
			<script type="text/javascript" defer  src="https://saif-it.pages.dev/closable.js"></script>
			<script type="text/javascript" defer  src="https://saif-it.pages.dev/copy-button.js"></script>
			<script type="text/javascript" defer  src="https://saif-it.pages.dev/theme-switcher.js"></script>

	<meta property="og:site_name" content="Saif Bin Shahab" />
	<meta property="og:title" content="Setting up ModSecurity WAF for Apache Webserver - Saif Bin Shahab" />
	<meta property="og:url" content="https://saif-it.pages.dev/blog/modsecurity-install-apache/" />
	<meta property="og:description" content="Saif Bin Shahab is an experienced Cyber Security Specialist and Software Developer. He is also the Founder of Vault47 Cyber Security." /><meta property="og:image" content="https://saif-it.pages.dev/card.png" /><meta property="og:locale" content="en_US" />
</head>

<body>
<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KBK5T6P9"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->

		
<header id="site-nav">
	<nav>
		<a href="#main-content" tabindex="0">
			Skip to Main Content
		</a>
		<ul>
			<li id="home">
				<a href="https://saif-it.pages.dev">
					<i class="icon"></i>Saif Bin Shahab</a>
			</li>
			<li class="divider"></li>
					<li>
						<a href="https://saif-it.pages.dev/blog/">Blog</a>
					</li>
					<li>
						<a href="https:&#x2F;&#x2F;github.com&#x2F;saifbinshahab" rel="" class="external">GitHub</a>
					</li>
					<li>
						<a href="https:&#x2F;&#x2F;www.linkedin.com&#x2F;in&#x2F;saif-bin-shahab" rel="" class="external">LinkedIn</a>
					</li>
				<li id="theme-switcher">
					<details class="closable">
						<summary class="circle" title="Theme">
							<i class="icon"></i>
						</summary>
						<ul>
							<li>
								<button class="circle" id="theme-light" title="Switch to Light Theme">
									<i class="icon"></i>
								</button>
							</li>
							<li>
								<button class="circle" id="theme-dark" title="Switch to Dark Theme">
									<i class="icon"></i>
								</button>
							</li>
							<li>
								<button class="circle" id="theme-system" title="Use System Theme">
									<i class="icon"></i>
								</button>
							</li>
						</ul>
					</details>
				</li><li id="feed">
					<details class="closable">
						<summary class="circle" title="Feed">
							<i class="icon"></i>
						</summary>
						<ul>
								<li>
									<a href="https://saif-it.pages.dev/rss.xml" rel="">RSS</a>
								</li>
								<li>
									<a href="https://saif-it.pages.dev/atom.xml" rel="">Atom</a>
								</li></ul>
					</details>
				</li>
		</ul>
	</nav>
</header>
<main id="main-content">
		<article><div id="heading"><p>
				<small>
					<time datetime=" 2025-08-25T00:00:00+00:00">Published on
						August 25, 2025</time></small>
			</p><h1>Setting up ModSecurity WAF for Apache Webserver</h1><p>
				<small><span>2 minutes read</span><span> • </span></small>
			</p>
				<ul class="tags"><li><a class="tag" href="https://saif-it.pages.dev/tags/linux/">Linux</a></li><li><a class="tag" href="https://saif-it.pages.dev/tags/homelab/">Homelab</a></li><li><a class="tag" href="https://saif-it.pages.dev/tags/devops/">DevOps</a></li><li><a class="tag" href="https://saif-it.pages.dev/tags/security/">Security</a></li><li><a class="tag" href="https://saif-it.pages.dev/tags/server/">Server</a></li>
				</ul>
	</div>

	<div id="buttons-container"><a id="go-to-top" href="#top" title="Go to Top"><i class="icon"></i></a><a id="share" href="https://shareopenly.org/share/?url=https:&#x2F;&#x2F;saif-it.pages.dev&#x2F;blog&#x2F;modsecurity-install-apache&#x2F;" rel="" title="Share"><i class="icon"></i></a></div><h2 id="install-modsecurity">Install ModSecurity</h2>
<pre data-lang="sh" class="language-sh z-code"><code class="language-sh" data-lang="sh"><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">sudo</span></span><span class="z-meta z-function-call z-arguments z-shell"> apt install<span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> -</span>y</span> libapache2-mod-security2</span>
</span></code></pre>
<p> </p>
<h2 id="setup-core-rule-set">Setup Core Rule Set</h2>
<p>We can learn more on <a href="https://coreruleset.org/">Core Rule Set Website</a> and <a href="https://github.com/coreruleset/coreruleset">Core Rule Set Github</a></p>
<h3 id="first-backup-the-existing-ruleset">First backup the existing ruleset</h3>
<pre data-lang="sh" class="language-sh z-code"><code class="language-sh" data-lang="sh"><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">sudo</span></span><span class="z-meta z-function-call z-arguments z-shell"> mv /usr/share/modsecurity-crs /usr/share/modsecurity-crs-backup</span>
</span></code></pre>
<p> </p>
<h3 id="download-or-clone-the-source-and-signature">Download or clone the source and signature</h3>
<ul>
<li>To Download:</li>
</ul>
<pre data-lang="sh" class="language-sh z-code"><code class="language-sh" data-lang="sh"><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">wget</span></span><span class="z-meta z-function-call z-arguments z-shell"> https://github.com/coreruleset/coreruleset/archive/refs/tags/v4.5.0.tar.gz</span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">wget</span></span><span class="z-meta z-function-call z-arguments z-shell"> https://github.com/coreruleset/coreruleset/releases/download/v4.5.0/coreruleset-4.5.0.tar.gz.asc</span>
</span></code></pre>
<ul>
<li>To clone:</li>
</ul>
<pre data-lang="sh" class="language-sh z-code"><code class="language-sh" data-lang="sh"><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">git</span></span><span class="z-meta z-function-call z-arguments z-shell"> clone https://github.com/coreruleset/coreruleset.git</span>
</span></code></pre>
<p> </p>
<h3 id="verify-signatures">Verify Signatures</h3>
<ul>
<li>Import GPG Keys:
To retrieve the CRS project’s public key from public key servers using <code>gpg</code>, execute: <code>gpg --keyserver pgp.mit.edu --recv 0x38EEACA1AB8A6E72</code>(this ID should be equal to the last sixteen hex characters in the fingerprint).</li>
</ul>
<p>It is also possible to use <code>gpg --fetch-key https://coreruleset.org/security.asc</code> to retrieve the key directly.
 </p>
<ul>
<li>To verify the integrity of the release:</li>
</ul>
<pre data-lang="sh" class="language-sh z-code"><code class="language-sh" data-lang="sh"><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">gpg</span></span><span class="z-meta z-function-call z-arguments z-shell"><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> --</span>verify</span> coreruleset-4.5.0.tar.gz.asc v4.5.0.tar.gz</span>
</span></code></pre>
<p>This should return:</p>
<pre data-lang="sh" class="language-sh z-code"><code class="language-sh" data-lang="sh"><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">gpg:</span></span><span class="z-meta z-function-call z-arguments z-shell"> Signature made Wed Jun 30 10:05:48 2021<span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> -</span>03</span></span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">gpg:</span></span><span class="z-meta z-function-call z-arguments z-shell">                using RSA key 36006F0E0BA167832158821138EEACA1AB8A6E72</span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">gpg:</span></span><span class="z-meta z-function-call z-arguments z-shell"> Good signature from <span class="z-string z-quoted z-double z-shell"><span class="z-punctuation z-definition z-string z-begin z-shell">&quot;</span>OWASP CRS &lt;security@coreruleset.org&gt;<span class="z-punctuation z-definition z-string z-end z-shell">&quot;</span></span> <span class="z-keyword z-control z-regexp z-set z-begin z-shell">[</span>unknown<span class="z-keyword z-control z-regexp z-set z-end z-shell">]</span></span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">gpg:</span></span><span class="z-meta z-function-call z-arguments z-shell"> WARNING: This key is not certified with a trusted signature!</span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">gpg:</span></span><span class="z-meta z-function-call z-arguments z-shell">          There is no indication that the signature belongs to the owner.</span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">Primary</span></span><span class="z-meta z-function-call z-arguments z-shell"> key fingerprint: 3600 6F0E 0BA1 6783 2158  8211 38EE ACA1 AB8A 6E72</span>
</span></code></pre>
<p>If the signature was good then the verification succeeds. If a warning is displayed, like the above, it means the CRS project’s public key is known but is not trusted.
 </p>
<ul>
<li>To trust the CRS project’s public key:</li>
</ul>
<pre data-lang="sh" class="language-sh z-code"><code class="language-sh" data-lang="sh"><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">gpg</span></span><span class="z-meta z-function-call z-arguments z-shell"><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> --</span>edit-key</span> 36006F0E0BA167832158821138EEACA1AB8A6E72</span>
</span><span class="z-source z-shell z-bash">
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">gpg</span></span><span class="z-meta z-function-call z-arguments z-shell"><span class="z-keyword z-operator z-assignment z-redirection z-shell">&gt;</span> trust</span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">Your</span></span><span class="z-meta z-function-call z-arguments z-shell"> decision: 5 (ultimate trust</span><span class="z-meta z-function-call z-shell"></span>)
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">Are</span></span><span class="z-meta z-function-call z-arguments z-shell"> you sure: Yes</span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">gpg</span></span><span class="z-meta z-function-call z-arguments z-shell"><span class="z-keyword z-operator z-assignment z-redirection z-shell">&gt;</span> quit</span>
</span></code></pre>
<p> </p>
<ul>
<li>The result when verifying a release will then look like so:</li>
</ul>
<pre data-lang="sh" class="language-sh z-code"><code class="language-sh" data-lang="sh"><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">gpg</span></span><span class="z-meta z-function-call z-arguments z-shell"><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> --</span>verify</span> coreruleset-4.5.0.tar.gz.asc v4.5.0.tar.gz</span>
</span><span class="z-source z-shell z-bash">
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">gpg:</span></span><span class="z-meta z-function-call z-arguments z-shell"> Signature made Wed Jun 30 15:05:48 2021 CEST</span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">gpg:</span></span><span class="z-meta z-function-call z-arguments z-shell">                using RSA key 36006F0E0BA167832158821138EEACA1AB8A6E72</span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">gpg:</span></span><span class="z-meta z-function-call z-arguments z-shell"> Good signature from <span class="z-string z-quoted z-double z-shell"><span class="z-punctuation z-definition z-string z-begin z-shell">&quot;</span>OWASP CRS &lt;security@coreruleset.org&gt;<span class="z-punctuation z-definition z-string z-end z-shell">&quot;</span></span> <span class="z-keyword z-control z-regexp z-set z-begin z-shell">[</span>ultimate<span class="z-keyword z-control z-regexp z-set z-end z-shell">]</span></span>
</span></code></pre>
<p> </p>
<h3 id="extract-core-rule-set">Extract Core Rule Set</h3>
<pre data-lang="sh" class="language-sh z-code"><code class="language-sh" data-lang="sh"><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">sudo</span></span><span class="z-meta z-function-call z-arguments z-shell"> tar<span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> -</span>xzvf</span> v4.5.0.tar.gz<span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> --</span>strip-components</span> 1<span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> -</span>C</span> /usr/share/modsecurity-crs</span>
</span></code></pre>
<p> </p>
<h3 id="activating-the-crs">Activating the CRS</h3>
<pre data-lang="sh" class="language-sh z-code"><code class="language-sh" data-lang="sh"><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">sudo</span></span><span class="z-meta z-function-call z-arguments z-shell"> mkdir /usr/share/modsecurity-crs</span>
</span><span class="z-source z-shell z-bash">
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">sudo</span></span><span class="z-meta z-function-call z-arguments z-shell"> mv /usr/share/modsecurity-crs/crs-setup.conf.example /usr/share/modsecurity-crs/crs-setup.conf</span>
</span></code></pre>
<p><em><strong>Note: We could also setup the crs in <code>/etc/crs</code> instead of <code>/usr/share/modsecurity-crs</code>.</strong></em>
 </p>
<h4 id="optional">(Optional)</h4>
<p>In addition to crs-setup.conf.example, there are two other “.example” files within the CRS repository. These are:</p>
<pre data-lang="sh" class="language-sh z-code"><code class="language-sh" data-lang="sh"><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">rules/REQUEST-900-EXCLUSION-RULES-BEFORE-CRS.conf.example</span></span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">rules/RESPONSE-999-EXCLUSION-RULES-AFTER-CRS.conf.example</span></span>
</span></code></pre>
<p>These files are designed to provide the rule maintainer with the ability to modify rules (see false positives and tuning) without breaking forward compatibility with rule set updates. These two files should be renamed by removing the .example suffix. <strong>This will mean that installing updates will <em>not</em> overwrite custom rule exclusions</strong>. To rename the files in Linux, use a command similar to the following:</p>
<pre data-lang="sh" class="language-sh z-code"><code class="language-sh" data-lang="sh"><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">sudo</span></span><span class="z-meta z-function-call z-arguments z-shell"> mv rules/REQUEST-900-EXCLUSION-RULES-BEFORE-CRS.conf.example rules/REQUEST-900-EXCLUSION-RULES-BEFORE-CRS.conf</span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">sudo</span></span><span class="z-meta z-function-call z-arguments z-shell"> mv rules/RESPONSE-999-EXCLUSION-RULES-AFTER-CRS.conf.example rules/RESPONSE-999-EXCLUSION-RULES-AFTER-CRS.conf</span>
</span></code></pre>
<p> </p>
<h2 id="configuring-and-setting-up-modsecurity">Configuring and Setting Up ModSecurity</h2>
<h3 id="activate-the-config">Activate the config</h3>
<pre data-lang="sh" class="language-sh z-code"><code class="language-sh" data-lang="sh"><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">sudo</span></span><span class="z-meta z-function-call z-arguments z-shell"> mv /etc/modsecurity/modsecurity.conf-recommended /etc/modsecurity/modsecurity.conf</span>
</span></code></pre>
<p>&amp;nbsp:</p>
<h3 id="configure-apache">Configure Apache</h3>
<pre data-lang="sh" class="language-sh z-code"><code class="language-sh" data-lang="sh"><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">sudo</span></span><span class="z-meta z-function-call z-arguments z-shell"> vim /etc/apache2/apache2.conf</span>
</span><span class="z-source z-shell z-bash">
</span><span class="z-source z-shell z-bash"><span class="z-comment z-line z-number-sign z-shell"><span class="z-punctuation z-definition z-comment z-begin z-shell">#</span></span><span class="z-comment z-line z-number-sign z-shell"> We can put these configs the very beginning of the config. You can try a different place if it causes any isues.</span><span class="z-comment z-line z-number-sign z-shell">
</span></span><span class="z-source z-shell z-bash">
</span><span class="z-source z-shell z-bash"><span class="z-keyword z-operator z-assignment z-redirection z-shell">&lt;</span>IfModule <span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">security2_module</span></span><span class="z-meta z-function-call z-arguments z-shell"><span class="z-keyword z-operator z-assignment z-redirection z-shell">&gt;</span>
</span></span><span class="z-source z-shell z-bash">	<span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">Include</span></span><span class="z-meta z-function-call z-arguments z-shell"> /etc/modsecurity/modsecurity.conf</span>
</span><span class="z-source z-shell z-bash">	<span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">Include</span></span><span class="z-meta z-function-call z-arguments z-shell"> /usr/share/modsecurity-crs/crs-setup.conf</span>
</span><span class="z-source z-shell z-bash">	<span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">Include</span></span><span class="z-meta z-function-call z-arguments z-shell"> /usr/share/modsecurity-crs/rules/<span class="z-keyword z-operator z-regexp z-quantifier z-shell">*</span>.conf</span>
</span><span class="z-source z-shell z-bash"><span class="z-keyword z-operator z-assignment z-redirection z-shell">&lt;</span>/IfModule<span class="z-keyword z-operator z-assignment z-redirection z-shell">&gt;</span>
</span></code></pre>
<p> </p>
<p>Also it’s a good practice to include similar configs in the apache default sites-enabled config file.</p>
<pre data-lang="sh" class="language-sh z-code"><code class="language-sh" data-lang="sh"><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">sudo</span></span><span class="z-meta z-function-call z-arguments z-shell"> vim /etc/apache2/sites-enabled/000-default.conf</span>
</span><span class="z-source z-shell z-bash">
</span><span class="z-source z-shell z-bash"><span class="z-comment z-line z-number-sign z-shell"><span class="z-punctuation z-definition z-comment z-begin z-shell">#</span></span><span class="z-comment z-line z-number-sign z-shell"> Now put the configs here. We can put the configs After &quot;DocumentRoot&quot; Inside &quot;&lt;VirtualHost *:80&gt;&quot;.</span><span class="z-comment z-line z-number-sign z-shell">
</span></span><span class="z-source z-shell z-bash">
</span><span class="z-source z-shell z-bash"><span class="z-comment z-line z-number-sign z-shell"><span class="z-punctuation z-definition z-comment z-begin z-shell">#</span></span><span class="z-comment z-line z-number-sign z-shell"> Note: In this config we didn&#39;t include &quot;/etc/modsecurity/modsecurity.conf&quot; because in our testing it was proving to be a misconfiguration.</span><span class="z-comment z-line z-number-sign z-shell">
</span></span><span class="z-source z-shell z-bash">
</span><span class="z-source z-shell z-bash"><span class="z-keyword z-operator z-assignment z-redirection z-shell">&lt;</span>IfModule <span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">security2_module</span></span><span class="z-meta z-function-call z-arguments z-shell"><span class="z-keyword z-operator z-assignment z-redirection z-shell">&gt;</span>
</span></span><span class="z-source z-shell z-bash">	<span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">Include</span></span><span class="z-meta z-function-call z-arguments z-shell"> /usr/share/modsecurity-crs/crs-setup.conf</span>
</span><span class="z-source z-shell z-bash">	<span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">Include</span></span><span class="z-meta z-function-call z-arguments z-shell"> /usr/share/modsecurity-crs/rules/<span class="z-keyword z-operator z-regexp z-quantifier z-shell">*</span>.conf</span>
</span><span class="z-source z-shell z-bash"><span class="z-keyword z-operator z-assignment z-redirection z-shell">&lt;</span>/IfModule<span class="z-keyword z-operator z-assignment z-redirection z-shell">&gt;</span>
</span></code></pre>
<p> </p>
<h3 id="activate-modsecurity">Activate ModSecurity</h3>
<pre data-lang="sh" class="language-sh z-code"><code class="language-sh" data-lang="sh"><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">sudo</span></span><span class="z-meta z-function-call z-arguments z-shell"> vim /etc/modsecurity/modsecurity.conf</span>
</span><span class="z-source z-shell z-bash">
</span><span class="z-source z-shell z-bash"><span class="z-comment z-line z-number-sign z-shell"><span class="z-punctuation z-definition z-comment z-begin z-shell">#</span></span><span class="z-comment z-line z-number-sign z-shell"> Change the config from &quot;SecRuleEngine DetectionOnly&quot; to &quot;SecRuleEngine On&quot;</span><span class="z-comment z-line z-number-sign z-shell">
</span></span><span class="z-source z-shell z-bash">
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">SecRuleEngine</span></span><span class="z-meta z-function-call z-arguments z-shell"> On</span>
</span></code></pre>
<p> </p>
<h2 id="now-restart-apache">Now Restart Apache</h2>
<pre data-lang="sh" class="language-sh z-code"><code class="language-sh" data-lang="sh"><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">sudo</span></span><span class="z-meta z-function-call z-arguments z-shell"> systemctl restart apache2</span>
</span></code></pre>
<p> </p>
<h2 id="now-we-can-test-the-security-recommended">Now we can test the security. (Recommended)</h2>
<p>Always verify that CRS is installed correctly by sending a ‘malicious’ request to your site or application, for instance:</p>
<pre data-lang="sh" class="language-sh z-code"><code class="language-sh" data-lang="sh"><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">curl</span></span><span class="z-meta z-function-call z-arguments z-shell"> <span class="z-string z-quoted z-single z-shell"><span class="z-punctuation z-definition z-string z-begin z-shell">&#39;</span>https://www.example.com/?foo=/etc/passwd&amp;bar=/bin/sh<span class="z-punctuation z-definition z-string z-end z-shell">&#39;</span></span></span>
</span></code></pre>
<p>Depending on your configurated thresholds, this should be detected as a malicious request. If you use blocking mode, you should receive an Error 403. The request should also be logged to the audit log, which is usually in <code>/var/log/modsec_audit.log</code>.
 </p>
<p>Done!</p>

</article><hr />
	<nav id="post-nav"><a class="post-nav-item post-nav-prev" href="https:&#x2F;&#x2F;saif-it.pages.dev&#x2F;blog&#x2F;modsecurity-install-nginx&#x2F;">
				<div class="nav-arrow">Previous</div>
				<span class="post-title">Setting up ModSecurity WAF for Nginx Webserver</span>
			</a><a class="post-nav-item post-nav-next" href="https:&#x2F;&#x2F;saif-it.pages.dev&#x2F;blog&#x2F;mariadb-setup&#x2F;">
				<div class="nav-arrow">Next</div>
				<span class="post-title">Installing MariaDB Properly on Linux</span>
			</a></nav>
		
	<span id="copy-code-text" class="hidden">Copy Code</span>

	</main>
	<footer id="site-footer">
			<p>&copy; Saif Bin Shahab, 2025</p>
		<ul id="socials">
				<li>
					<a href="https://github.com/saifbinshahab" rel=" me" title="GitHub">
						<i class="icon" style='--icon: url("data:image/svg+xml,%3Csvg role=&#x27;img&#x27; viewBox=&#x27;0 0 24 24&#x27; xmlns=&#x27;http:&#x2F;&#x2F;www.w3.org&#x2F;2000&#x2F;svg&#x27;%3E%3Ctitle%3EGitHub%3C&#x2F;title%3E%3Cpath d=&#x27;M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12&#x27;&#x2F;%3E%3C&#x2F;svg%3E")'></i>
						<span>GitHub</span>
					</a>
				</li>
				<li>
					<a href="https://www.linkedin.com/in/saif-bin-shahab" rel=" me" title="LinkedIn">
						<i class="icon" style='--icon: url("data:image/svg+xml,%3Csvg xmlns=&#x27;http:&#x2F;&#x2F;www.w3.org&#x2F;2000&#x2F;svg&#x27; x=&#x27;0px&#x27; y=&#x27;0px&#x27; width=&#x27;100&#x27; height=&#x27;100&#x27; viewBox=&#x27;0 0 50 50&#x27;%3E%3Cpath d=&#x27;M41,4H9C6.24,4,4,6.24,4,9v32c0,2.76,2.24,5,5,5h32c2.76,0,5-2.24,5-5V9C46,6.24,43.76,4,41,4z M17,20v19h-6V20H17z M11,14.47c0-1.4,1.2-2.47,3-2.47s2.93,1.07,3,2.47c0,1.4-1.12,2.53-3,2.53C12.2,17,11,15.87,11,14.47z M39,39h-6c0,0,0-9.26,0-10 c0-2-1-4-3.5-4.04h-0.08C27,24.96,26,27.02,26,29c0,0.91,0,10,0,10h-6V20h6v2.56c0,0,1.93-2.56,5.81-2.56 c3.97,0,7.19,2.73,7.19,8.26V39z&#x27;%3E%3C&#x2F;path%3E%3C&#x2F;svg%3E")'></i>
						<span>LinkedIn</span>
					</a>
				</li>
				<li>
					<a href="mailto:saifbinshahab@proton.me" rel=" me" title="Mail">
						<i class="icon" style='--icon: url("data:image/svg+xml,%3Csvg role=&#x27;img&#x27; viewBox=&#x27;0 0 24 24&#x27; xmlns=&#x27;http:&#x2F;&#x2F;www.w3.org&#x2F;2000&#x2F;svg&#x27;%3E%3Ctitle%3EGmail%3C&#x2F;title%3E%3Cpath d=&#x27;M24 5.457v13.909c0 .904-.732 1.636-1.636 1.636h-3.819V11.73L12 16.64l-6.545-4.91v9.273H1.636A1.636 1.636 0 0 1 0 19.366V5.457c0-2.023 2.309-3.178 3.927-1.964L5.455 4.64 12 9.548l6.545-4.91 1.528-1.145C21.69 2.28 24 3.434 24 5.457z&#x27;&#x2F;%3E%3C&#x2F;svg%3E")'></i>
						<span>Mail</span>
					</a>
				</li>
				<li>
					<a href="https://mastodon.social/@saifbinshahab" rel=" me" title="Mastodon">
						<i class="icon" style='--icon: url("data:image/svg+xml,%3Csvg role=&#x27;img&#x27; viewBox=&#x27;0 0 24 24&#x27; xmlns=&#x27;http:&#x2F;&#x2F;www.w3.org&#x2F;2000&#x2F;svg&#x27;%3E%3Ctitle%3EMastodon%3C&#x2F;title%3E%3Cpath d=&#x27;M23.268 5.313c-.35-2.578-2.617-4.61-5.304-5.004C17.51.242 15.792 0 11.813 0h-.03c-3.98 0-4.835.242-5.288.309C3.882.692 1.496 2.518.917 5.127.64 6.412.61 7.837.661 9.143c.074 1.874.088 3.745.26 5.611.118 1.24.325 2.47.62 3.68.55 2.237 2.777 4.098 4.96 4.857 2.336.792 4.849.923 7.256.38.265-.061.527-.132.786-.213.585-.184 1.27-.39 1.774-.753a.057.057 0 0 0 .023-.043v-1.809a.052.052 0 0 0-.02-.041.053.053 0 0 0-.046-.01 20.282 20.282 0 0 1-4.709.545c-2.73 0-3.463-1.284-3.674-1.818a5.593 5.593 0 0 1-.319-1.433.053.053 0 0 1 .066-.054c1.517.363 3.072.546 4.632.546.376 0 .75 0 1.125-.01 1.57-.044 3.224-.124 4.768-.422.038-.008.077-.015.11-.024 2.435-.464 4.753-1.92 4.989-5.604.008-.145.03-1.52.03-1.67.002-.512.167-3.63-.024-5.545zm-3.748 9.195h-2.561V8.29c0-1.309-.55-1.976-1.67-1.976-1.23 0-1.846.79-1.846 2.35v3.403h-2.546V8.663c0-1.56-.617-2.35-1.848-2.35-1.112 0-1.668.668-1.67 1.977v6.218H4.822V8.102c0-1.31.337-2.35 1.011-3.12.696-.77 1.608-1.164 2.74-1.164 1.311 0 2.302.5 2.962 1.498l.638 1.06.638-1.06c.66-.999 1.65-1.498 2.96-1.498 1.13 0 2.043.395 2.74 1.164.675.77 1.012 1.81 1.012 3.12z&#x27;&#x2F;%3E%3C&#x2F;svg%3E")'></i>
						<span>Mastodon</span>
					</a>
				</li>
				<li>
					<a href="https://x.com/saifbinshahab" rel=" me" title="Twitter">
						<i class="icon" style='--icon: url("data:image/svg+xml,%3Csvg role=&#x27;img&#x27; viewBox=&#x27;0 0 24 24&#x27; xmlns=&#x27;http:&#x2F;&#x2F;www.w3.org&#x2F;2000&#x2F;svg&#x27;%3E%3Ctitle%3ETwitter%3C&#x2F;title%3E%3Cpath d=&#x27;M21.543 7.104c.015.211.015.423.015.636 0 6.507-4.954 14.01-14.01 14.01v-.003A13.94 13.94 0 0 1 0 19.539a9.88 9.88 0 0 0 7.287-2.041 4.93 4.93 0 0 1-4.6-3.42 4.916 4.916 0 0 0 2.223-.084A4.926 4.926 0 0 1 .96 9.167v-.062a4.887 4.887 0 0 0 2.235.616A4.928 4.928 0 0 1 1.67 3.148 13.98 13.98 0 0 0 11.82 8.292a4.929 4.929 0 0 1 8.39-4.49 9.868 9.868 0 0 0 3.128-1.196 4.941 4.941 0 0 1-2.165 2.724A9.828 9.828 0 0 0 24 4.555a10.019 10.019 0 0 1-2.457 2.549z&#x27;&#x2F;%3E%3C&#x2F;svg%3E")'></i>
						<span>Twitter</span>
					</a>
				</li>
		</ul>
</footer>


</body>
</html>
